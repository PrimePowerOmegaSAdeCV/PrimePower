<?xml version="1.0" encoding="utf-8"?>
<odoo>
	<record id="add_approval_buttons_and_state_in_sale_order_form_view"
		model="ir.ui.view">
		<field name="name">add.approval.buttons.and.state.in.sale.order.view</field>
		<field name="model">sale.order</field>
		<field name="inherit_id" ref="sale.view_order_form" />
		<field name="arch" type="xml">
			<field name="state" position="attributes">
				<attribute name="statusbar_visible">draft,sent,send_for_approval,sale</attribute>
			</field>
			<xpath expr="//field[@name='name']" position="after">
				<field name="credit_approval" invisible="1"/>
			</xpath>
			<xpath expr="//button[@name='action_quotation_send']" position="after">
				<button name="accept_approval" string="Aprobar Credito" type="object" class="oe_highlight"
						attrs="{'invisible':['|',('type_id','=',2),('state','!=','send_for_approval')]}"
						groups="credit_limit_approval.credit_approval"/>
			</xpath>
			<xpath expr="//button[@name='accept_approval']" position="after">
				<button name="reject_approval" string="Rechazar Credito" type="object" class="oe_highlight"
						attrs="{'invisible':['|',('type_id','=',2),('state','!=','send_for_approval')]}"
						groups="credit_limit_approval.credit_approval"/>
			</xpath>
			<xpath expr="//header/button[@name='action_confirm'][2]" position="attributes">
				<attribute name="attrs">{'invisible':[('state','not in',('draft'))]}</attribute>
			</xpath>
			<xpath expr="//header/button[@name='action_confirm']" position="attributes">
				<attribute name="attrs">{'invisible':[('state','in',('sale','draft','cancel','send_for_approval'))]}
				</attribute>
			</xpath>
		</field>
	</record>
</odoo>
